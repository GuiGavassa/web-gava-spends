<div *ngIf="aberto" class="modal-overlay" (click)="fecharModal()">
  <div class="modal-conteudo" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h3>{{ tipo === 'credito' ? 'Adicionar Cartão de Crédito' : 'Adicionar Conta/Débito' }}</h3>
      <button class="btn-fechar" (click)="fecharModal()">&times;</button>
    </div>
    
    <div class="modal-body">
      <!-- Formulário para Cartão de Crédito -->
      <div *ngIf="tipo === 'credito'">
        <div class="form-group">
          <label>Nome do Cartão</label>
          <input 
            type="text" 
            [(ngModel)]="novoItem.nome" 
            class="input-field"
            placeholder="Ex: Santander, Nubank"
          />
        </div>

        <div class="form-group">
          <label>Limite</label>
          <input 
            type="number" 
            [(ngModel)]="novoItem.limite" 
            class="input-field"
            placeholder="Limite do cartão"
          />
        </div>

        <div class="form-group">
          <label>Cor de Destaque</label>
          <div class="seletor-cores">
            <div 
              *ngFor="let cor of coresPredefinidas" 
              class="cor-opcao"
              [class.selecionada]="corSelecionada === cor.valor"
              [style.background-color]="cor.valor"
              (click)="selecionarCor(cor.valor)"
              [title]="cor.nome"
            ></div>
            <div 
              class="cor-opcao outras"
              [class.selecionada]="mostrarSeletorCor"
              (click)="abrirSeletorCor()"
              title="Escolher outra cor"
            ></div>
          </div>
          
          <div *ngIf="mostrarSeletorCor" class="seletor-cor-custom">
            <input 
              type="color" 
              [(ngModel)]="corSelecionada"
              (ngModelChange)="atualizarCorCustomizada($event)"
            />
            <span class="cor-hex">{{ corSelecionada }}</span>
            <div class="cor-preview" [style.background-color]="corSelecionada"></div>
          </div>
        </div>
      </div>

      <!-- Formulário para Conta/Débito -->
      <div *ngIf="tipo === 'debito'">
        <div class="form-group">
          <label>Nome da Conta</label>
          <input 
            type="text" 
            [(ngModel)]="novoItem.nome" 
            class="input-field"
            placeholder="Ex: Conta Corrente Santander"
          />
        </div>

        <div class="form-group">
          <label>Tipo</label>
          <select [(ngModel)]="novoItem.tipo" class="input-field">
            <option value="debito">Débito</option>
            <option value="conta">Conta Corrente</option>
          </select>
        </div>

        <div class="form-group">
          <label>Saldo Atual</label>
          <input 
            type="number" 
            [(ngModel)]="novoItem.saldo" 
            class="input-field"
            placeholder="Saldo atual"
          />
        </div>

        <div class="form-group">
          <label>Cor de Destaque</label>
          <div class="seletor-cores">
            <div 
              *ngFor="let cor of coresPredefinidas" 
              class="cor-opcao"
              [class.selecionada]="corSelecionada === cor.valor"
              [style.background-color]="cor.valor"
              (click)="selecionarCor(cor.valor)"
              [title]="cor.nome"
            ></div>
            <div 
              class="cor-opcao outras"
              [class.selecionada]="mostrarSeletorCor"
              (click)="abrirSeletorCor()"
              title="Escolher outra cor"
            ></div>
          </div>
          
          <div *ngIf="mostrarSeletorCor" class="seletor-cor-custom">
            <input 
              type="color" 
              [(ngModel)]="corSelecionada"
              (ngModelChange)="atualizarCorCustomizada($event)"
            />
            <span class="cor-hex">{{ corSelecionada }}</span>
            <div class="cor-preview" [style.background-color]="corSelecionada"></div>
          </div>
        </div>
      </div>
    </div>

    <div class="modal-footer">
      <button (click)="fecharModal()" class="btn-cancelar">Cancelar</button>
      <button (click)="salvar()" class="btn-salvar">Adicionar</button>
    </div>
  </div>
</div>
